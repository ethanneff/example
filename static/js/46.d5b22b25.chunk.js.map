{"version":3,"sources":["apps/Playground/SlotMachine/utils.ts","apps/Playground/SlotMachine/config.ts","apps/Playground/SlotMachine/SlotMachine.tsx","apps/Playground/SlotMachine/index.tsx"],"names":["getWinsPerCombination","combinations","reels","output","i","length","freq","j","element","reel","sum","getSumOfReel","Object","values","reduce","item","getSumOfReels","total","getSumOfCombinations","combination","getRandomReelArrays","arrays","array","keys","key","amount","k","push","shuffleArray","a","copy","swap","temp","Math","floor","random","any","Reels","memo","reelsArray","lineIndexes","color","useColor","View","style","flexDirection","map","borderWidth","borderColor","primary","background","title","Bet","onBet","disable","multiplier","disabled","onPress","justifyContent","alignItems","bold","emphasis","name","SlotMachine","multipliers","randomize","credits","useState","activity","multiplierIndex","getInitialState","state","setState","wildCards","useMemo","line","sort","b","getWildCards","creditError","onSpin","useCallback","remainingCredits","p","winningLine","lineIndex","getWinningLine","winningAmount","wildCard","includes","getWinningAmount","setTimeout","console","log","onMultiplier","nextIndex","center","padding","Theme","p02","type","winPercentage","sumOfReels","winsPerCombination","getWinPercentage","toFixed","returnPercentage","returnsPerCombination","index","payout","getReturnsPerCombination","getReturnPercentage","nav","useNav","tokens","spinning","active","styles","StyleSheet","create","container","backgroundColor","navBack","onLeftPress","flex"],"mappings":"wLAEMA,EAAwB,SAC5BC,EACAC,GAGA,IADA,IAAMC,EAAM,YAAOF,GACVG,EAAI,EAAGA,EAAIH,EAAaI,OAAQD,IAAK,CAC5C,IAAIE,EAAO,EACXH,EAAOC,GAAP,YAAgBH,EAAaG,IAC7B,IAAK,IAAIG,EAAI,EAAGA,EAAIL,EAAMG,OAAQE,IAAK,CACrC,IAAMC,EAAUL,EAAOC,GAAGG,GACpBE,EAAOP,EAAMK,GACbG,EAAMC,EAAaF,GACzBH,GACc,QAAZE,GAAwC,kBAAZA,EAAuBC,EAAKD,GAAWE,EAEvEP,EAAOC,GAAG,GAAKE,EAEjB,OAAOH,GAGHQ,EAAe,SAACF,GACpB,OAAOG,OAAOC,OAAOJ,GAAMK,QAAO,SAACJ,EAAKK,GAAN,OAAeL,EAAMK,IAAM,IAGzDC,EAAgB,SAACd,GACrB,OAAOA,EAAMY,QAAO,SAACG,EAAOR,GAAR,OAAiBQ,EAAQN,EAAaF,KAAO,IAiB7DS,EAAuB,SAACjB,GAC5B,OAAOA,EAAaa,QAAO,SAACG,EAAOE,GAAR,OAAwBF,EAAQE,EAAY,KAAI,IA2BhEC,EAAsB,SAAClB,GAElC,IADA,IAAMmB,EAAsB,GACnBjB,EAAI,EAAGA,EAAIF,EAAMG,OAAQD,IAAK,CAIrC,IAHA,IAAMkB,EAAmB,GACnBb,EAAOP,EAAME,GACbmB,EAAOX,OAAOW,KAAKd,GAChBF,EAAI,EAAGA,EAAIgB,EAAKlB,OAAQE,IAG/B,IAFA,IAAMiB,EAAMD,EAAKhB,GACXkB,EAAShB,EAAKe,GACXE,EAAI,EAAGA,EAAID,EAAQC,IAC1BJ,EAAMK,KAAKH,GAGfH,EAAOM,KAAKL,GAEd,IAAK,IAAIlB,EAAI,EAAGA,EAAIiB,EAAOhB,OAAQD,IACjCiB,EAAOjB,GAAKwB,EAAaP,EAAOjB,IAGlC,OAAOiB,GAGIO,EAAe,SAAIN,GAQ9B,IAPA,IAMqBO,EANfC,EAAI,YAAOR,GACXS,EAAO,SAACF,EAAQzB,EAAWG,GAC/B,IAAMyB,EAAOH,EAAEzB,GACfyB,EAAEzB,GAAKyB,EAAEtB,GACTsB,EAAEtB,GAAKyB,GAGA5B,EAAI,EAAGA,EAAI0B,EAAKzB,OAAQD,IAAK,CAEpC2B,EAAKD,EAAM1B,GAHQyB,EAEGC,EAFQG,KAAKC,MAAMD,KAAKE,SAAWN,EAAExB,UAK7D,OAAOyB,GC7FI7B,EAA6B,CACxC,CAAC,eAAM,eAAM,eAAM,KACnB,CAAC,eAAM,eAAM,eAAM,KACnB,CAAC,eAAM,eAAM,eAAM,KACnB,CAAC,eAAM,eAAM,eAAM,KACnB,CAAC,eAAM,eAAM,eAAM,IACnB,CAAC,eAAM,eAAM,eAAM,IACnB,CAAC,eAAM,eAAM,eAAM,IACnB,CAAC,eAAM,eAAM,eAAM,IACnB,CAAC,eAAM,eAAM,eAAM,IACnB,CAAC,eAAM,eAAM,eAAM,IACnB,CAAC,eAAM,eAAM,eAAM,GACnB,CAAC,eAAM,eAAM,MAAO,GACpB,CAAC,eAAM,MAAO,MAAO,IAMVC,EAAe,CAC1B,CACE,eAAM,EACN,eAAM,EACN,eAAM,EACN,eAAM,EACN,eAAM,EACN,eAAM,EACN,eAAM,EACN,eAAM,EACNkC,IAAK,GAEP,CACE,eAAM,EACN,eAAM,EACN,eAAM,EACN,eAAM,EACN,eAAM,EACN,eAAM,EACN,eAAM,EACN,eAAM,EACNA,IAAK,GAEP,CACE,eAAM,EACN,eAAM,EACN,eAAM,EACN,eAAM,EACN,eAAM,EACN,eAAM,EACN,eAAM,EACN,eAAM,EACNA,IAAK,I,OCkCHC,EAAQC,gBAAK,YAAuD,IAAvCC,EAAsC,EAAtCA,WAAYC,EAA0B,EAA1BA,YACvCC,EAAQC,cACd,OACE,kBAACC,EAAA,EAAD,CAAMC,MAAO,CAACC,cAAe,QAC1BN,EAAWO,KAAI,SAACrC,EAAML,GAAP,OACd,kBAACuC,EAAA,EAAD,CAAMnB,IAAG,UAAKpB,IACXK,EAAKqC,KAAI,SAAC/B,EAAMR,GAAP,OACR,kBAAC,IAAD,CACEiB,IAAG,UAAKpB,GAAL,OAASG,GAAT,OAAaQ,GAChB6B,MAAO,CACLG,YAAa,EACbC,YACER,EAAYpC,KAAOG,EAAIkC,EAAMQ,QAAUR,EAAMS,YAEjDC,MAAOpC,eAefqC,EAAMd,gBAAK,YAAsD,IAAxCe,EAAuC,EAAvCA,MAAOC,EAAgC,EAAhCA,QAASC,EAAuB,EAAvBA,WACvCd,EAAQC,cACd,OACE,kBAAC,IAAD,CACEc,SAAUF,EACVG,QAASJ,EACTT,MAAO,CACLC,cAAe,MACfa,eAAgB,SAChBC,WAAY,WAEd,kBAAC,IAAD,CAAMC,MAAI,EAACC,SAAS,OAAOV,MAAK,eAAUI,KAC1C,kBAAC,IAAD,CAAMd,MAAOA,EAAMQ,QAASa,KAAK,uBAK1BC,EAAczB,gBAAK,YAMrB,IALTrC,EAKQ,EALRA,aACAC,EAIQ,EAJRA,MAIQ,IAHR8D,mBAGQ,MAHM,CAAC,EAAG,EAAG,EAAG,EAAG,GAAI,IAGvB,EAFRC,EAEQ,EAFRA,UACAC,EACQ,EADRA,QACQ,EACkBC,oBAAgB,kBAtHpB,SAAC,GAAsD,IAArDF,EAAoD,EAApDA,UAAW/D,EAAyC,EAAzCA,MAInC,MAAO,CACLkE,SAAU,OACVF,QAN0E,EAAlCA,QAOxC3B,WANiB0B,EACf/D,EAAM4C,KAAI,SAACrC,GAAD,OAAUmB,EAAa,YAAKnB,OACtCP,EAAM4C,KAAI,SAACrC,GAAD,mBAAeA,MAK3B4D,gBAAiB,EACjB7B,YAAa,CAAC,EAAG,EAAG,IA8GpB8B,CAAgB,CAACL,YAAW/D,QAAOgE,eAF7B,mBACDK,EADC,KACMC,EADN,KAIFjB,EAAaS,EAAYO,EAAMF,iBAC/Bf,EAA6B,aAAnBiB,EAAMH,SAChBK,EAAYC,mBAAQ,kBA9GP,SACnBzE,EACAC,GAEA,IAAMuE,EAAuB,GAQ7B,OAPA7D,OAAOW,KAAKtB,GAAc6C,KAAI,SAAC3B,GAK7B,OAJwB,YAAQA,GACTd,OAASH,EAAMG,QACpCoE,EAAU9C,KAAK,CAACgD,KAAMxD,EAAaM,OAAQxB,EAAakB,KAEnDA,KAEFsD,EAAUG,MAAK,SAAC/C,EAAGgD,GAAJ,OAAUA,EAAEpD,OAASI,EAAEJ,UAkGbqD,CAAa7E,EAAcC,KAAQ,CACjED,EACAC,IAGI6E,EACe,yBAAnBR,EAAMH,SAAsC,uBAAyB,GAEjEY,EAASC,uBAAY,WACzB,IAAMC,EAAmBX,EAAML,QAAUX,EACzC,GAAI2B,EAAmB,EACrBV,GAAS,SAACW,GAAD,sBAAYA,EAAZ,CAAef,SAAU,gCADpC,CAIA,IAAM5B,EAAmC+B,EAAMhC,WA5G/BO,KAAI,SAACrC,GAAD,OAAUwB,KAAKC,MAAMD,KAAKE,SAAW1B,EAAKJ,WA6GxD+E,EA1Ga,SACrB5C,EACAD,GAEA,OAAOC,EAAY1B,QAAO,SAACG,EAAOoE,EAAWjF,GAE3C,OADAa,GAASsB,EAAWnC,GAAGiF,KAEtB,IAmGmBC,CAAe9C,EAAa+B,EAAMhC,YAChDgD,EAjGe,SACvBZ,EACA1E,EACAwE,GAEA,IAAMtD,EAAclB,EAAa0E,GACjC,GAAIxD,EACF,OAAOA,EAET,IAAK,IAAIf,EAAI,EAAGA,EAAIqE,EAAUpE,OAAQD,IAAK,CACzC,IAAMoF,EAAWf,EAAUrE,GAC3B,GAAIuE,EAAKc,SAASD,EAASb,MACzB,OAAOa,EAAS/D,OAGpB,OAAO,EAkFiBiE,CACpBN,EACAnF,EACAwE,GAGFD,GAAS,SAACW,GAAD,sBACJA,EADI,CAEPf,SAAU,WACV5B,cACA0B,QAASgB,OAEXS,YAAW,WACTC,QAAQC,IAAIT,EAAaG,GACzBf,GAAS,SAACW,GAAD,sBACJA,EADI,CAEPf,SAAU,OACVF,QAASiB,EAAEjB,QAAUqB,EAAgBhC,SAEtC,QACF,CAACtD,EAAcsD,EAAYgB,EAAML,QAASK,EAAMhC,WAAYkC,IAEzDqB,EAAeb,uBAAY,WAC/BT,GAAS,SAACW,GACR,IAAMY,EAAYZ,EAAEd,gBAAkB,EAChCA,EACJL,EAAY3D,QAAU0F,GAAaZ,EAAEjB,QAAUF,EAAY+B,GACvD,EACAA,EACN,OAAO,eAAIZ,EAAX,CAAcd,yBAEf,CAACL,IAEJ,OACE,kBAACrB,EAAA,EAAD,KACE,kBAAC,EAAD,CAAOH,YAAa+B,EAAM/B,YAAaD,WAAYgC,EAAMhC,aACzD,kBAAC,EAAD,CAAKe,QAASA,EAASC,WAAYA,EAAYF,MAAOyC,IACtD,kBAAC,IAAD,CACEE,QAAM,EACNnC,SAAS,OACTjB,MAAO,CAACqD,QAASC,IAAMD,QAAQE,KAC/BhD,MAAK,UAAKoB,EAAML,QAAX,YACLkC,KAAK,OAEP,kBAAC,IAAD,CACE3D,MAAM,UACNa,QAASA,EACTO,SAAS,OACTJ,QAASuB,EACT7B,MAAM,SAER,kBAAC,IAAD,CACE6C,QAAM,EACNvD,MAAM,SACNoB,SAAS,OACTjB,MAAO,CAACqD,QAASC,IAAMD,QAAQE,KAC/BhD,MAAO4B,QCxNTsB,GAAyD,IHoC/B,SAC9BpG,EACAC,GAEA,IAAMoG,EAAatF,EAAcd,GAC3BqG,EAAqBvG,EAAsBC,EAAcC,GAE/D,OADkBgB,EAAqBqF,GACpBD,EG3CEE,CAAiBvG,EAAcC,IAAcuG,QAAQ,GACtEC,GACuC,IH4CV,SACjCzG,EACAC,GAEA,IAAMoG,EAAatF,EAAcd,GAE3ByG,EAlCyB,SAC/B1G,EACAsG,GAEA,OAAOA,EAAmBzF,QACxB,SAACX,EAAsBgB,EAAayF,GAClC,IAAMC,EAAS5G,EAAa2G,GAAO,GAEnC,OADAzG,EAAOyG,GAAO,GAAKzF,EAAY,GAAK0F,EAC7B1G,IAJJ,YAMDoG,IAwBwBO,CAC5B7G,EAFyBD,EAAsBC,EAAcC,IAM/D,OADqBgB,EAAqByF,GACpBL,EGvDtBS,CAAoB9G,EAAcC,IAClCuG,QAAQ,GASKnE,0BAAK,WAClB,IAAMG,EAAQC,cACRsE,EAAMC,cAFuC,EAIzB9C,oBAAS,iBAXN,CAC7B+C,OAAQ,GACRC,UAAU,EACVC,OAAQlH,EAAM4C,KAAI,kBAAM,KACxB5C,MAAOkB,EAAoBlB,OAGwB,mBAI5CqE,EAJ4C,KAIrCC,EAJqC,KAK7C6C,EAASC,IAAWC,OAAO,CAC/BC,UAAW,CACTC,gBAAiBhF,EAAMS,cAGrBwE,EAAUzC,sBAAY+B,EAAI,cAAe,CAACA,IAE1ChC,EAASC,uBAAY,WACzBT,GAAS,SAACW,GAAD,sBAAYA,EAAZ,CAAegC,UAAU,SACjC,IAEH,OACE,kBAAC,IAAD,CAAQQ,YAAaD,EAASvE,MAAM,gBAClC,kBAACR,EAAA,EAAD,CAAMC,MAAOyE,EAAOG,WAClB,kBAAC,IAAD,CAAMrE,MAAK,0BAAqBkD,EAArB,OACX,kBAAC,IAAD,CAAMlD,MAAK,6BAAwBuD,EAAxB,OACX,kBAAC,IAAD,CAAMvD,MAAK,UAAKoB,KAEhB,kBAAC,IAAD,CAAQd,QAASuB,EAAQ7B,MAAM,SAC/B,kBAACR,EAAA,EAAD,CACEC,MAAO,CACLgF,KAAM,EACNlE,eAAgB,SAChBC,WAAY,YAGhB,kBAAC,EAAD,CACE1D,aAAc,CACZ,uCAAU,IACV,uCAAU,IACV,uCAAU,IACV,uCAAU,IACV,uCAAU,GACV,uCAAU,GACV,uCAAU,GACV,uCAAU,GACV,uCAAU,GACV,uCAAU,GACV,uCAAU,EACV,2BAAQ,EACR,eAAM,GAERiE,QAAS,GACTD,WAAS,EACT/D,MAAO,CACL,+SACA,+SACA","file":"static/js/46.d5b22b25.chunk.js","sourcesContent":["import {Combinations, Element, Reel, Reels} from './config';\n\nconst getWinsPerCombination = (\n  combinations: Combinations,\n  reels: Reels,\n): Combinations => {\n  const output = [...combinations];\n  for (let i = 0; i < combinations.length; i++) {\n    let freq = 1;\n    output[i] = [...combinations[i]];\n    for (let j = 0; j < reels.length; j++) {\n      const element = output[i][j];\n      const reel = reels[j];\n      const sum = getSumOfReel(reel);\n      freq *=\n        element !== 'any' && typeof element !== 'number' ? reel[element] : sum;\n    }\n    output[i][3] = freq;\n  }\n  return output;\n};\n\nconst getSumOfReel = (reel: Reel): number => {\n  return Object.values(reel).reduce((sum, item) => sum + item, 0);\n};\n\nconst getSumOfReels = (reels: Reels): number => {\n  return reels.reduce((total, reel) => total * getSumOfReel(reel), 1);\n};\n\nconst getReturnsPerCombination = (\n  combinations: Combinations,\n  winsPerCombination: Combinations,\n): Combinations => {\n  return winsPerCombination.reduce(\n    (output: Combinations, combination, index) => {\n      const payout = combinations[index][3];\n      output[index][3] = combination[3] * payout;\n      return output;\n    },\n    [...winsPerCombination],\n  );\n};\n\nconst getSumOfCombinations = (combinations: Combinations): number => {\n  return combinations.reduce((total, combination) => total + combination[3], 0);\n};\n\nexport const getWinPercentage = (\n  combinations: Combinations,\n  reels: Reels,\n): number => {\n  const sumOfReels = getSumOfReels(reels);\n  const winsPerCombination = getWinsPerCombination(combinations, reels);\n  const sumOfWins = getSumOfCombinations(winsPerCombination);\n  return sumOfWins / sumOfReels;\n};\n\nexport const getReturnPercentage = (\n  combinations: Combinations,\n  reels: Reels,\n): number => {\n  const sumOfReels = getSumOfReels(reels);\n  const winsPerCombination = getWinsPerCombination(combinations, reels);\n  const returnsPerCombination = getReturnsPerCombination(\n    combinations,\n    winsPerCombination,\n  );\n  const sumOfReturns = getSumOfCombinations(returnsPerCombination);\n  return sumOfReturns / sumOfReels;\n};\n\nexport const getRandomReelArrays = (reels: Reels): Element[][] => {\n  const arrays: Element[][] = [];\n  for (let i = 0; i < reels.length; i++) {\n    const array: Element[] = [];\n    const reel = reels[i];\n    const keys = Object.keys(reel);\n    for (let j = 0; j < keys.length; j++) {\n      const key = keys[j] as Element;\n      const amount = reel[key];\n      for (let k = 0; k < amount; k++) {\n        array.push(key);\n      }\n    }\n    arrays.push(array);\n  }\n  for (let i = 0; i < arrays.length; i++) {\n    arrays[i] = shuffleArray(arrays[i]);\n  }\n\n  return arrays;\n};\n\nexport const shuffleArray = <T>(array: T[]): T[] => {\n  const copy = [...array];\n  const swap = (a: T[], i: number, j: number) => {\n    const temp = a[i];\n    a[i] = a[j];\n    a[j] = temp;\n  };\n  const randomIndex = (a: T[]) => Math.floor(Math.random() * a.length);\n  for (let i = 0; i < copy.length; i++) {\n    const j = randomIndex(copy);\n    swap(copy, i, j);\n  }\n  return copy;\n};\n","export type Element =\n  | '🍓'\n  | '🍇'\n  | '🍉'\n  | '🥭'\n  | '🍏'\n  | '🍊'\n  | '🍒'\n  | '🍋'\n  | 'any';\ntype Combination = [Element, Element, Element, number];\nexport type Combinations = Combination[];\n\nexport const combinations: Combinations = [\n  ['🍓', '🍓', '🍓', 200],\n  ['🍇', '🍇', '🍇', 100],\n  ['🍉', '🍉', '🍉', 100],\n  ['🍉', '🍉', '🍇', 100],\n  ['🥭', '🥭', '🥭', 18],\n  ['🥭', '🥭', '🍇', 18],\n  ['🍏', '🍏', '🍏', 14],\n  ['🍏', '🍏', '🍇', 14],\n  ['🍊', '🍊', '🍊', 10],\n  ['🍊', '🍊', '🍇', 10],\n  ['🍒', '🍒', '🍒', 8],\n  ['🍒', '🍒', 'any', 5],\n  ['🍒', 'any', 'any', 2],\n];\n\nexport type Reel = {[key in Element]: number};\nexport type Reels = [Reel, Reel, Reel];\n\nexport const reels: Reels = [\n  {\n    '🍓': 1,\n    '🍇': 1,\n    '🍉': 2,\n    '🥭': 5,\n    '🍏': 5,\n    '🍊': 5,\n    '🍒': 4,\n    '🍋': 2,\n    any: 0,\n  },\n  {\n    '🍓': 1,\n    '🍇': 2,\n    '🍉': 2,\n    '🥭': 3,\n    '🍏': 3,\n    '🍊': 5,\n    '🍒': 7,\n    '🍋': 2,\n    any: 0,\n  },\n  {\n    '🍓': 1,\n    '🍇': 1,\n    '🍉': 2,\n    '🥭': 4,\n    '🍏': 2,\n    '🍊': 5,\n    '🍒': 5,\n    '🍋': 5,\n    any: 0,\n  },\n];\n","import React, {memo, useCallback, useMemo, useState} from 'react';\nimport {View} from 'react-native';\nimport {Button, Icon, Text, TouchableOpacity} from '../../../components';\nimport {useColor} from '../../../hooks';\nimport {Theme} from '../../../utils';\nimport {shuffleArray} from './utils';\n\ntype Combinations = {[key: string]: number};\ntype WildCards = {line: string; amount: number}[];\ntype Props = {\n  reels: string[];\n  combinations: Combinations;\n  credits: number;\n  multipliers?: number[];\n  startingPositions?: number[];\n  randomize?: boolean;\n  debug?: boolean;\n};\n\ntype State = {\n  activity: 'idle' | 'spinning' | 'insufficient credits';\n  credits: number;\n  reelsArray: string[][];\n  multiplierIndex: number;\n  lineIndexes: number[];\n};\n\ntype InitialState = {\n  randomize?: boolean;\n  reels: string[];\n  credits: number;\n};\n\nconst getInitialState = ({randomize, reels, credits}: InitialState): State => {\n  const reelsArray = randomize\n    ? reels.map((reel) => shuffleArray([...(reel as any)]))\n    : reels.map((reel) => [...(reel as any)]);\n  return {\n    activity: 'idle',\n    credits,\n    reelsArray,\n    multiplierIndex: 0,\n    lineIndexes: [0, 0, 0],\n  };\n};\n\nconst getWildCards = (\n  combinations: Combinations,\n  reels: string[],\n): WildCards => {\n  const wildCards: WildCards = [];\n  Object.keys(combinations).map((combination) => {\n    const unicodeCombination = [...(combination as any)];\n    if (unicodeCombination.length < reels.length) {\n      wildCards.push({line: combination, amount: combinations[combination]});\n    }\n    return combination;\n  });\n  return wildCards.sort((a, b) => b.amount - a.amount);\n};\n\nconst getRandomLineIndexes = (reelsArray: string[][]): number[] => {\n  return reelsArray.map((reel) => Math.floor(Math.random() * reel.length));\n};\n\nconst getWinningLine = (\n  lineIndexes: number[],\n  reelsArray: string[][],\n): string => {\n  return lineIndexes.reduce((total, lineIndex, i) => {\n    total += reelsArray[i][lineIndex];\n    return total;\n  }, '');\n};\n\nconst getWinningAmount = (\n  line: string,\n  combinations: Combinations,\n  wildCards: WildCards,\n): number => {\n  const combination = combinations[line];\n  if (combination) {\n    return combination;\n  }\n  for (let i = 0; i < wildCards.length; i++) {\n    const wildCard = wildCards[i];\n    if (line.includes(wildCard.line)) {\n      return wildCard.amount;\n    }\n  }\n  return 0;\n};\n\ntype ReelsProps = {\n  reelsArray: string[][];\n  lineIndexes: number[];\n};\n\nconst Reels = memo(function Reels({reelsArray, lineIndexes}: ReelsProps) {\n  const color = useColor();\n  return (\n    <View style={{flexDirection: 'row'}}>\n      {reelsArray.map((reel, i) => (\n        <View key={`${i}`}>\n          {reel.map((item, j) => (\n            <Text\n              key={`${i}${j}${item}`}\n              style={{\n                borderWidth: 2,\n                borderColor:\n                  lineIndexes[i] === j ? color.primary : color.background,\n              }}\n              title={item}\n            />\n          ))}\n        </View>\n      ))}\n    </View>\n  );\n});\n\ntype BetProps = {\n  disable: boolean;\n  multiplier: number;\n  onBet: () => void;\n};\n\nconst Bet = memo(function Bet({onBet, disable, multiplier}: BetProps) {\n  const color = useColor();\n  return (\n    <TouchableOpacity\n      disabled={disable}\n      onPress={onBet}\n      style={{\n        flexDirection: 'row',\n        justifyContent: 'center',\n        alignItems: 'center',\n      }}>\n      <Text bold emphasis=\"high\" title={`BET X${multiplier}`} />\n      <Icon color={color.primary} name=\"lightning-bolt\" />\n    </TouchableOpacity>\n  );\n});\n\nexport const SlotMachine = memo(function SlotMachine({\n  combinations,\n  reels,\n  multipliers = [1, 2, 3, 5, 10, 20],\n  randomize,\n  credits,\n}: Props) {\n  const [state, setState] = useState<State>(() =>\n    getInitialState({randomize, reels, credits}),\n  );\n  const multiplier = multipliers[state.multiplierIndex];\n  const disable = state.activity === 'spinning';\n  const wildCards = useMemo(() => getWildCards(combinations, reels), [\n    combinations,\n    reels,\n  ]);\n\n  const creditError =\n    state.activity === 'insufficient credits' ? 'insufficient credits' : '';\n\n  const onSpin = useCallback(() => {\n    const remainingCredits = state.credits - multiplier;\n    if (remainingCredits < 0) {\n      setState((p) => ({...p, activity: 'insufficient credits'}));\n      return;\n    }\n    const lineIndexes = getRandomLineIndexes(state.reelsArray);\n    const winningLine = getWinningLine(lineIndexes, state.reelsArray);\n    const winningAmount = getWinningAmount(\n      winningLine,\n      combinations,\n      wildCards,\n    );\n\n    setState((p) => ({\n      ...p,\n      activity: 'spinning',\n      lineIndexes,\n      credits: remainingCredits,\n    }));\n    setTimeout(() => {\n      console.log(winningLine, winningAmount);\n      setState((p) => ({\n        ...p,\n        activity: 'idle',\n        credits: p.credits + winningAmount * multiplier,\n      }));\n    }, 500);\n  }, [combinations, multiplier, state.credits, state.reelsArray, wildCards]);\n\n  const onMultiplier = useCallback(() => {\n    setState((p) => {\n      const nextIndex = p.multiplierIndex + 1;\n      const multiplierIndex =\n        multipliers.length <= nextIndex || p.credits < multipliers[nextIndex]\n          ? 0\n          : nextIndex;\n      return {...p, multiplierIndex};\n    });\n  }, [multipliers]);\n\n  return (\n    <View>\n      <Reels lineIndexes={state.lineIndexes} reelsArray={state.reelsArray} />\n      <Bet disable={disable} multiplier={multiplier} onBet={onMultiplier} />\n      <Text\n        center\n        emphasis=\"high\"\n        style={{padding: Theme.padding.p02}}\n        title={`${state.credits} credits`}\n        type=\"h4\"\n      />\n      <Button\n        color=\"primary\"\n        disable={disable}\n        emphasis=\"high\"\n        onPress={onSpin}\n        title=\"spin\"\n      />\n      <Text\n        center\n        color=\"danger\"\n        emphasis=\"high\"\n        style={{padding: Theme.padding.p02}}\n        title={creditError}\n      />\n    </View>\n  );\n});\n","import React, {memo, useCallback, useState} from 'react';\nimport {StyleSheet, View} from 'react-native';\nimport {Button, Screen, Text} from '../../../components';\nimport {useColor, useNav} from '../../../hooks';\nimport {\n  getRandomReelArrays,\n  getReturnPercentage,\n  getWinPercentage,\n} from './utils';\nimport {combinations, reels} from './config';\nimport {SlotMachine} from './SlotMachine';\n\nconst winPercentage = (getWinPercentage(combinations, reels) * 100).toFixed(2);\nconst returnPercentage = (\n  getReturnPercentage(combinations, reels) * 100\n).toFixed(2);\n\nconst getInitialState = () => ({\n  tokens: 14,\n  spinning: false,\n  active: reels.map(() => 0),\n  reels: getRandomReelArrays(reels),\n});\n\nexport default memo(function PlaygroundSlotMachine() {\n  const color = useColor();\n  const nav = useNav();\n\n  const [state, setState] = useState(() => getInitialState());\n  const styles = StyleSheet.create({\n    container: {\n      backgroundColor: color.background,\n    },\n  });\n  const navBack = useCallback(nav('playground'), [nav]);\n\n  const onSpin = useCallback(() => {\n    setState((p) => ({...p, spinning: true}));\n  }, []);\n\n  return (\n    <Screen onLeftPress={navBack} title=\"Slot Machine\">\n      <View style={styles.container}>\n        <Text title={`win percentage: ${winPercentage}%`} />\n        <Text title={`return percentage: ${returnPercentage}%`} />\n        <Text title={`${state}`} />\n\n        <Button onPress={onSpin} title=\"spin\" />\n        <View\n          style={{\n            flex: 1,\n            justifyContent: 'center',\n            alignItems: 'center',\n          }}\n        />\n        <SlotMachine\n          combinations={{\n            '🍓🍓🍓': 200,\n            '🍇🍇🍇': 100,\n            '🍉🍉🍉': 100,\n            '🍉🍉🍇': 100,\n            '🥭🥭🥭': 18,\n            '🥭🥭🍇': 18,\n            '🍏🍏🍏': 14,\n            '🍏🍏🍇': 14,\n            '🍊🍊🍊': 10,\n            '🍊🍊🍇': 10,\n            '🍒🍒🍒': 8,\n            '🍒🍒': 5,\n            '🍒': 2,\n          }}\n          credits={20}\n          randomize\n          reels={[\n            '🍓🍇🍉🍉🥭🥭🥭🥭🥭🍏🍏🍏🍏🍏🍊🍊🍊🍊🍊🍒🍒🍒🍒🍋🍋',\n            '🍓🍇🍇🍉🍉🥭🥭🥭🍏🍏🍏🍊🍊🍊🍊🍊🍒🍒🍒🍒🍒🍒🍒🍋🍋',\n            '🍓🍇🍉🍉🥭🥭🥭🥭🍏🍏🍊🍊🍊🍊🍊🍒🍒🍒🍒🍒🍋🍋🍋🍋🍋',\n          ]}\n        />\n      </View>\n    </Screen>\n  );\n});\n\n// var WinningSound = () => {\n//   return (\n//     <audio autoPlay=\"autoplay\" className=\"player\" preload=\"false\">\n//       <source src=\"https://andyhoffman.codes/random-assets/img/slots/winning_slot.wav\" />\n//     </audio>\n//   );\n// };\n\n// class App extends React.PureComponent {\n//   constructor(props) {\n//     super(props);\n//     this.state = {\n//       winner: null,\n//     };\n//     this.finishHandler = this.finishHandler.bind(this);\n//     this.handleClick = this.handleClick.bind(this);\n//   }\n\n//   handleClick() {\n//     this.setState({winner: null});\n//     this.emptyArray();\n//     this._child1.forceUpdateHandler();\n//     this._child2.forceUpdateHandler();\n//     this._child3.forceUpdateHandler();\n//   }\n\n//   static loser = [\n//     'Not quite',\n//     'Stop gambling',\n//     'Hey, you lost!',\n//     'Ouch! I felt that',\n//     \"Don't beat yourself up\",\n//     'There goes the college fund',\n//     'I have a cat. You have a loss',\n//     \"You're awesome at losing\",\n//     'Coding is hard',\n//     \"Don't hate the coder\",\n//   ];\n\n//   static matches = [];\n\n//   finishHandler(value) {\n//     App.matches.push(value);\n\n//     if (App.matches.length === 3) {\n//       const {winner} = this.state;\n//       const first = App.matches[0];\n//       let results = App.matches.every((match) => match === first);\n//       this.setState({winner: results});\n//     }\n//   }\n\n//   emptyArray() {\n//     App.matches = [];\n//   }\n\n//   render() {\n//     return (\n//       <>\n//         <View className=\"spinner-container\">\n//           <Spinner\n//             onFinish={this.finishHandler}\n//             ref={(child) => {\n//               this._child1 = child;\n//             }}\n//             timer=\"1000\"\n//           />\n//           <Spinner\n//             onFinish={this.finishHandler}\n//             ref={(child) => {\n//               this._child2 = child;\n//             }}\n//             timer=\"1400\"\n//           />\n//           <Spinner\n//             onFinish={this.finishHandler}\n//             ref={(child) => {\n//               this._child3 = child;\n//             }}\n//             timer=\"2200\"\n//           />\n//         </View>\n//         <Button onClick={this.handleClick} title=\"repeatButton\" />\n//       </>\n//     );\n//   }\n// }\n\n// class Spinner extends React.PureComponent {\n//   constructor(props) {\n//     super(props);\n//     this.forceUpdateHandler = this.forceUpdateHandler.bind(this);\n//   }\n\n//   forceUpdateHandler() {\n//     this.reset();\n//   }\n\n//   reset() {\n//     if (this.timer) {\n//       clearInterval(this.timer);\n//     }\n\n//     this.start = this.setStartPosition();\n\n//     this.setState({\n//       position: this.start,\n//       timeRemaining: this.props.timer,\n//     });\n\n//     this.timer = setInterval(() => {\n//       this.tick();\n//     }, 100);\n//   }\n\n//   state = {\n//     position: 0,\n//     lastPosition: null,\n//   };\n//   static iconHeight = 188;\n//   multiplier = Math.floor(Math.random() * (4 - 1) + 1);\n\n//   start = this.setStartPosition();\n//   speed = Spinner.iconHeight * this.multiplier;\n\n//   setStartPosition() {\n//     return Math.floor(Math.random() * 9) * Spinner.iconHeight * -1;\n//   }\n\n//   moveBackground() {\n//     this.setState({\n//       position: this.state.position - this.speed,\n//       timeRemaining: this.state.timeRemaining - 100,\n//     });\n//   }\n\n//   getSymbolFromPosition() {\n//     let {position} = this.state;\n//     const totalSymbols = 9;\n//     const maxPosition = Spinner.iconHeight * (totalSymbols - 1) * -1;\n//     let moved = (this.props.timer / 100) * this.multiplier;\n//     let startPosition = this.start;\n//     let currentPosition = startPosition;\n\n//     for (let i = 0; i < moved; i++) {\n//       currentPosition -= Spinner.iconHeight;\n\n//       if (currentPosition < maxPosition) {\n//         currentPosition = 0;\n//       }\n//     }\n\n//     this.props.onFinish(currentPosition);\n//   }\n\n//   tick() {\n//     if (this.state.timeRemaining <= 0) {\n//       clearInterval(this.timer);\n//       this.getSymbolFromPosition();\n//     } else {\n//       this.moveBackground();\n//     }\n//   }\n\n//   componentDidMount() {\n//     clearInterval(this.timer);\n\n//     this.setState({\n//       position: this.start,\n//       timeRemaining: this.props.timer,\n//     });\n\n//     this.timer = setInterval(() => {\n//       this.tick();\n//     }, 100);\n//   }\n\n//   render() {\n//     let {position, current} = this.state;\n\n//     return (\n//       <View\n//         className=\"icons\"\n//         style={{backgroundPosition: '0px ' + position + 'px'}}\n//       />\n//     );\n//   }\n// }\n\n// // (function ($) {\n// //   var slotMachine = (function () {\n// //     var credits = 15,\n// //       spinning = 3,\n// //       spin = [0, 0, 0],\n// //       slotsTypes = {\n// //         🍒: [2, 5, 10],\n// //         🍊: [0, 15, 30],\n// //         🍐: [0, 40, 50],\n// //         🔔: [0, 50, 80],\n// //         🍋: [0, 0, 100],\n// //         🥝: [0, 0, 150],\n// //         🍉: [0, 0, 250],\n// //         🍍: [0, 0, 500],\n// //         anybar: [0, 0, 80],\n// //       },\n// //       slots = [\n// //         [\n// //           '🍊',\n// //           '🔔',\n// //           '🍊',\n// //           '🥝',\n// //           '🍐',\n// //           '🍊',\n// //           '🍉',\n// //           '🍐',\n// //           '🍊',\n// //           '🍋',\n// //           '🔔',\n// //           '🍒',\n// //           '🍊',\n// //           '🍐',\n// //           '🔔',\n// //           '🍋',\n// //           '🍒',\n// //           '🍍',\n// //           '🍊',\n// //           '🍐',\n// //           '🍊',\n// //           '🔔',\n// //           '🍊',\n// //         ],\n// //         [\n// //           '🍒',\n// //           '🍐',\n// //           '🍊',\n// //           '🔔',\n// //           '🍋',\n// //           '🍒',\n// //           '🍐',\n// //           '🍉',\n// //           '🍒',\n// //           '🔔',\n// //           '🍊',\n// //           '🍋',\n// //           '🍍',\n// //           '🍒',\n// //           '🥝',\n// //           '🍒',\n// //           '🔔',\n// //           '🍐',\n// //           '🍒',\n// //           '🍊',\n// //           '🍒',\n// //           '🍐',\n// //           '🍊',\n// //         ],\n// //         [\n// //           '🍒',\n// //           '🍊',\n// //           '🔔',\n// //           '🍐',\n// //           '🥝',\n// //           '🍒',\n// //           '🍐',\n// //           '🍊',\n// //           '🍉',\n// //           '🍒',\n// //           '🔔',\n// //           '🍊',\n// //           '🍒',\n// //           '🍊',\n// //           '🍒',\n// //           '🍐',\n// //           '🍋',\n// //           '🍍',\n// //           '🔔',\n// //           '🍒',\n// //           '🍒',\n// //           '🍊',\n// //           '🔔',\n// //         ],\n// //       ],\n// //       startSlot = function () {\n// //         spinning = false;\n\n// //         $('#slot-trigger').removeClass('slot-triggerDisabled');\n\n// //         this.blur();\n\n// //         return false;\n// //       },\n// //       endSlot = function () {\n// //         $('#slot-block').show();\n// //         $('#slot-credits').text('VERLOREN!!!');\n\n// //         setInterval(blink($('#slot-credits')), 1000);\n// //       },\n// //       addCredit = function (incrementCredits) {\n// //         var currentCredits = credits;\n// //         credits += incrementCredits;\n\n// //         blink($('#slot-credits'));\n\n// //         $('#slot-credits')\n// //           .css('credit', 0)\n// //           .animate(\n// //             {\n// //               credit: incrementCredits,\n// //             },\n// //             {\n// //               duration: 400 + incrementCredits,\n// //               easing: 'easeOut',\n// //               step: function (now) {\n// //                 $(this).html(parseInt(currentCredits + now, 10));\n// //               },\n// //               complete: function () {\n// //                 $(this).html(credits);\n// //                 blink($('#slot-credits'));\n// //               },\n// //             },\n// //           );\n// //       },\n// //       spin = function () {\n// //         this.blur();\n\n// //         if (spinning == false) {\n// //           $('#slot-machine .arm').animate({top: '45px', height: '2%'});\n// //           $('#slot-machine .arm .knob').animate({top: '-20px', height: '20px'});\n// //           $('#slot-machine .arm-shadow').animate({top: '40px'}, 380);\n// //           $(\n// //             '#slot-machine .ring1 .shadow, #slot-machine .ring2 .shadow',\n// //           ).animate({top: '50%', opacity: 1});\n\n// //           spinning = 3;\n// //           credits--;\n\n// //           $('#slot-credits').html(credits);\n\n// //           spin[0] = parseInt(Math.random() * 23);\n// //           spin[1] = parseInt(Math.random() * 23);\n// //           spin[2] = parseInt(Math.random() * 23);\n\n// //           $('#slot-trigger').addClass('slot-triggerDisabled');\n\n// //           $('img.slotSpinAnimation').show();\n\n// //           $('#wheel1 img:first').css('top', -(spin[0] * 44 + 16) + 'px');\n// //           $('#wheel2 img:first').css('top', -(spin[1] * 44 + 16) + 'px');\n// //           $('#wheel3 img:first').css('top', -(spin[2] * 44 + 16) + 'px');\n\n// //           setTimeout(function () {\n// //             $('#slot-machine .arm').animate({\n// //               top: '-25px',\n// //               height: '50%',\n// //               overflow: 'visible',\n// //             });\n// //             $('#slot-machine .arm .knob').animate({\n// //               top: '-15px',\n// //               height: '16px',\n// //             });\n// //             $('#slot-machine .arm-shadow').animate({top: '13px'});\n// //             $(\n// //               '#slot-machine .ring1 .shadow, #slot-machine .ring2 .shadow',\n// //             ).animate({top: '0', opacity: 0});\n// //           }, 500);\n\n// //           setTimeout(function () {\n// //             stopSpin(1);\n// //           }, 1500 + parseInt(1500 * Math.random()));\n\n// //           setTimeout(function () {\n// //             stopSpin(2);\n// //           }, 1500 + parseInt(1500 * Math.random()));\n\n// //           setTimeout(function () {\n// //             stopSpin(3);\n// //           }, 1500 + parseInt(1500 * Math.random()));\n// //         }\n\n// //         return false;\n// //       },\n// //       stopSpin = function (slot) {\n// //         $('#wheel' + slot)\n// //           .find('img:last')\n// //           .hide()\n// //           .end()\n// //           .find('img:first')\n// //           .animate(\n// //             {\n// //               top: -spin[slot - 1] * 44,\n// //             },\n// //             {\n// //               duration: 500,\n// //               easing: 'elasticOut',\n// //               complete: function () {\n// //                 spinning--;\n\n// //                 if (spinning <= 0) {\n// //                   endSpin();\n// //                 }\n// //               },\n// //             },\n// //           );\n// //       },\n// //       endSpin = function () {\n// //         var slotType = slots[0][spin[0]],\n// //           matches = 1,\n// //           barMatch = /bar/.test(slotType) ? 1 : 0,\n// //           winnedCredits = 0,\n// //           waitToSpin = 10;\n\n// //         if (slotType == slots[1][spin[1]]) {\n// //           matches++;\n\n// //           if (slotType == slots[2][spin[2]]) {\n// //             matches++;\n// //           } else if (barMatch != 0 && /bar/.test(slots[2][spin[2]])) {\n// //             barMatch++;\n// //           }\n// //         } else if (barMatch != 0 && /bar/.test(slots[1][spin[1]])) {\n// //           barMatch++;\n\n// //           if (/bar/.test(slots[2][spin[2]])) {\n// //             barMatch++;\n// //           }\n// //         }\n\n// //         if (matches != 3 && barMatch == 3) {\n// //           slotType = 'anybar';\n// //           matches = 3;\n// //         }\n\n// //         var winnedCredits = slotsTypes[slotType][matches - 1];\n\n// //         if (winnedCredits > 0) {\n// //           addCredit(winnedCredits);\n// //           waitToSpin = 410 + winnedCredits;\n// //         }\n\n// //         setTimeout(function () {\n// //           if (credits == 0) {\n// //             endSlot();\n// //           } else {\n// //             $('#slot-trigger').removeClass('slot-triggerDisabled');\n// //             spinning = false;\n// //           }\n// //         }, waitToSpin);\n// //       };\n// //     return {\n// //       init: function () {\n// //         startSlot();\n\n// //         $('#slot-trigger')\n// //           .bind('mousedown', function () {\n// //             $(this).addClass('slot-triggerDown');\n// //           })\n// //           .bind('click', spin);\n\n// //         $(document).bind('mouseup', function () {\n// //           $('#slot-trigger').removeClass('slot-triggerDown');\n// //         });\n\n// //         $('#wheel1 img:first').css(\n// //           'top',\n// //           -(parseInt(Math.random() * 23) * 44) + 'px',\n// //         );\n// //         $('#wheel2 img:first').css(\n// //           'top',\n// //           -(parseInt(Math.random() * 23) * 44) + 'px',\n// //         );\n// //         $('#wheel3 img:first').css(\n// //           'top',\n// //           -(parseInt(Math.random() * 23) * 44) + 'px',\n// //         );\n// //       },\n// //     };\n// //   })();\n\n// //   $.extend($.easing, {\n// //     bounceOut: function (x, t, b, c, d) {\n// //       if ((t /= d) < 1 / 2.75) {\n// //         return c * (7.5625 * t * t) + b;\n// //       } else if (t < 2 / 2.75) {\n// //         return c * (7.5625 * (t -= 1.5 / 2.75) * t + 00.75) + b;\n// //       } else if (t < 2.5 / 2.75) {\n// //         return c * (7.5625 * (t -= 2.25 / 2.75) * t + 00.9375) + b;\n// //       } else {\n// //         return c * (7.5625 * (t -= 2.625 / 2.75) * t + 00.984375) + b;\n// //       }\n// //     },\n// //     easeOut: function (x, t, b, c, d) {\n// //       return -c * (t /= d) * (t - 2) + b;\n// //     },\n// //     elasticOut: function (x, t, b, c, d) {\n// //       var s = 1.70158;\n// //       var p = 0;\n// //       var a = c;\n// //       if (t == 0) return b;\n// //       if ((t /= d) == 1) return b + c;\n// //       if (!p) p = d * 00.3;\n// //       if (a < Math.abs(c)) {\n// //         a = c;\n// //         var s = p / 4;\n// //       } else var s = (p / (2 * Math.PI)) * Math.asin(c / a);\n// //       return (\n// //         a * Math.pow(2, -10 * t) * Math.sin(((t * d - s) * (2 * Math.PI)) / p) +\n// //         c +\n// //         b,\n// //       );\n// //     },\n// //   });\n\n// //   $(document).ready(slotMachine.init);\n// // })(jQuery);\n\n// // function blink(element) {\n// //   element.animate({opacity: 0}, 200, 'linear', function () {\n// //     $(this).animate({opacity: 1}, 200);\n// //   });\n// // }\n"],"sourceRoot":""}